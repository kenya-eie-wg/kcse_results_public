position = position_dodge(width = .9),
vjust = -.3) +
scale_fill_manual(values = c("#1fa187", "#440154")) +
labs(title = "Mean score by sex and year",
y = "Number of children",
x = "",
caption = "Results from 2019 Kakuma and Kalobeyei were excluded sinve ")
kcse %>%
filter(!is.na(sex)) %>%
group_by(year, sex) %>%
summarise(mean_score = mean(mean_score, na.rm = TRUE),
count = n()) %>%
mutate(score_multiplied = mean_score * count) %>%
rbind(
kk_2019_number_candidates %>%
left_join(score_convert, by = "grade") %>%
group_by(sex, score) %>%
summarise(count = sum(count, na.rm = TRUE)) %>%
mutate(score_multiplied = score * count) %>%
group_by(sex) %>%
summarise(count = sum(count),
score_multiplied = sum(score_multiplied)) %>%
mutate(mean_score = score_multiplied / count) %>%
mutate(year = 2019)
) %>%
group_by(year, sex) %>%
summarise(score_multiplied = sum(score_multiplied),
count = sum(count)) %>%
mutate(mean_score = score_multiplied / count) %>%
ggplot(aes(x = year, y = mean_score, fill = sex)) +
geom_col(position = position_dodge()) +
geom_text(aes(label = round(mean_score, digits = 2)),
position = position_dodge(width = .9),
vjust = -.3) +
scale_fill_manual(values = c("#1fa187", "#440154")) +
labs(title = "Mean score by sex and year",
y = "Number of children",
x = "",
caption = "Results from 2019 Kakuma and Kalobeyei were excluded sinve ")
kcse %>%
filter(area == "dadaab" & !is.na(sex) & is_stem == "STEM" & year != 2019) %>%
ggplot(aes(x = score, colour = sex)) +
geom_density(size = .5, alpha = .3, adjust = 2) +
scale_colour_manual(values = c("#11b86c", "#a90ecf")) +
geom_vline(data = dadaab_mean_stem, aes(xintercept = mean_stem_score,
colour = sex),
lty = 2, size = .1, alpha = .8, show.legend = FALSE) +
scale_x_continuous(breaks = seq(0, 12, by = 1)) +
facet_wrap(~ year) +
theme(strip.background = element_rect(fill = "black"),
strip.text = element_text(face = "bold", size = 8),
plot.caption = element_text(hjust = .5)) +
guides(colour = guide_legend(override.aes = list(shape = 19))) +
labs(x = "Candidate STEM scores",
y = "Density",
title = "Distribution of mean STEM scores by year and sex",
subtitle = "Mean score by sex marked by dotted lines",
colour = "Sex",
caption = "2019 excluded due to small sample size")
kcse %>%
filter(area == "dadaab" & !is.na(sex) & is_stem == "STEM" & year != 2019) %>%
ggplot(aes(x = score, colour = sex)) +
geom_density(size = 1, alpha = .3, adjust = 2) +
scale_colour_manual(values = c("#11b86c", "#a90ecf")) +
geom_vline(data = dadaab_mean_stem, aes(xintercept = mean_stem_score,
colour = sex),
lty = 2, size = .1, alpha = .8, show.legend = FALSE) +
scale_x_continuous(breaks = seq(0, 12, by = 1)) +
facet_wrap(~ year) +
theme(strip.background = element_rect(fill = "black"),
strip.text = element_text(face = "bold", size = 8),
plot.caption = element_text(hjust = .5)) +
guides(colour = guide_legend(override.aes = list(shape = 19))) +
labs(x = "Candidate STEM scores",
y = "Density",
title = "Distribution of mean STEM scores by year and sex",
subtitle = "Mean score by sex marked by dotted lines",
colour = "Sex",
caption = "2019 excluded due to small sample size")
kcse %>%
filter(area == "dadaab" & !is.na(sex) & is_stem == "STEM" & year != 2019) %>%
ggplot(aes(x = score, colour = sex)) +
geom_density(size = .4, alpha = .3, adjust = 3) +
scale_colour_manual(values = c("#11b86c", "#a90ecf")) +
geom_vline(data = dadaab_mean_stem, aes(xintercept = mean_stem_score,
colour = sex),
lty = 2, size = .1, alpha = .8, show.legend = FALSE) +
scale_x_continuous(breaks = seq(0, 12, by = 1)) +
facet_wrap(~ year) +
theme(strip.background = element_rect(fill = "black"),
strip.text = element_text(face = "bold", size = 8),
plot.caption = element_text(hjust = .5)) +
guides(colour = guide_legend(override.aes = list(shape = 19))) +
labs(x = "Candidate STEM scores",
y = "Density",
title = "Distribution of mean STEM scores by year and sex",
subtitle = "Mean score by sex marked by dotted lines",
colour = "Sex",
caption = "2019 excluded due to small sample size")
kcse %>%
mutate(area = ifelse(area != "dadaab", "Kakuma_Kalobeyei", "Dadaab")) %>%
filter(subject %out% c("maths_b",
"general_science",
"kenyan_sign_language")) %>%
group_by(year, area, subject, is_stem) %>%
summarise(score = mean(score, na.rm = TRUE)) %>%
pivot_wider(names_from = year, values_from = score, names_prefix = "year_") %>%
filter(!is.na(year_2018) & !is.na(year_2022) & year_2018 != 0) %>%
mutate(increase = (year_2022 - year_2018) / year_2018)
kcse %>%
mutate(area = ifelse(area != "dadaab", "Kakuma_Kalobeyei", "Dadaab")) %>%
filter(subject %out% c("maths_b",
"general_science",
"kenyan_sign_language")) %>%
group_by(year, area, subject, is_stem) %>%
summarise(score = mean(score, na.rm = TRUE))
kk_2019_raw %>% glimpse()
kk_2019_raw %>% glimpse()
kk_2019_raw
kk_2019_raw <- read_csv("./data/kk_2019_raw.csv")
kk_2019_raw
kcse %>%
mutate(area = ifelse(area != "dadaab", "Kakuma_Kalobeyei", "Dadaab")) %>%
filter(subject %out% c("maths_b",
"general_science",
"kenyan_sign_language")) %>%
group_by(year, area, subject, is_stem) %>%
summarise(score = mean(score, na.rm = TRUE))
kk_2019_raw %>%
mutate(is_stem = ifelse(subject %in% c("biology", "chemistry", "computer_studies",
"general_science", "maths", "physics"),
"STEM", "non-STEM"),
area = ifelse(area == "kk", "Kakuma_Kalobeyei", area)) %>%
mutate(subtotal = number_candidates * score) %>%
group_by(year, subject, area) %>%
summarise(subtotal = sum(subtotal),
count = sum(number_candidates)) %>%
mutate(mean_score = subtotal / count)
kk_2019_raw %>%
mutate(is_stem = ifelse(subject %in% c("biology", "chemistry", "computer_studies",
"general_science", "maths", "physics"),
"STEM", "non-STEM"),
area = ifelse(area == "kk", "Kakuma_Kalobeyei", area)) %>%
mutate(subtotal = number_candidates * score) %>%
group_by(year, subject, area, is_stem) %>%
summarise(subtotal = sum(subtotal),
count = sum(number_candidates)) %>%
mutate(mean_score = subtotal / count)
kcse %>%
mutate(area = ifelse(area != "dadaab", "Kakuma_Kalobeyei", "Dadaab")) %>%
filter(subject %out% c("maths_b",
"general_science",
"kenyan_sign_language")) %>%
group_by(year, area, subject, is_stem) %>%
summarise(score = mean(score, na.rm = TRUE))
summary_flat <- kcse %>%
mutate(area = ifelse(area != "dadaab", "Kakuma_Kalobeyei", "Dadaab")) %>%
filter(subject %out% c("maths_b",
"general_science",
"kenyan_sign_language")) %>%
group_by(year, area, subject, is_stem) %>%
summarise(score = mean(score, na.rm = TRUE)) %>%
rbind(
kk_2019_raw %>%
mutate(is_stem = ifelse(subject %in% c("biology", "chemistry", "computer_studies",
"general_science", "maths", "physics"),
"STEM", "non-STEM"),
area = ifelse(area == "kk", "Kakuma_Kalobeyei", area)) %>%
mutate(subtotal = number_candidates * score) %>%
group_by(year, subject, area, is_stem) %>%
summarise(subtotal = sum(subtotal),
count = sum(number_candidates)) %>%
mutate(mean_score = subtotal / count)
)
summary_flat <- kcse %>%
mutate(area = ifelse(area != "dadaab", "Kakuma_Kalobeyei", "Dadaab")) %>%
filter(subject %out% c("maths_b",
"general_science",
"kenyan_sign_language")) %>%
group_by(year, area, subject, is_stem) %>%
summarise(score = mean(score, na.rm = TRUE)) %>%
rbind(
kk_2019_raw %>%
mutate(is_stem = ifelse(subject %in% c("biology", "chemistry", "computer_studies",
"general_science", "maths", "physics"),
"STEM", "non-STEM"),
area = ifelse(area == "kk", "Kakuma_Kalobeyei", area)) %>%
mutate(subtotal = number_candidates * score) %>%
group_by(year, subject, area, is_stem) %>%
summarise(subtotal = sum(subtotal),
count = sum(number_candidates)) %>%
mutate(mean_score = subtotal / count)
) %>%
pivot_wider(names_from = year, values_from = score, names_prefix = "year_") %>%
filter(!is.na(year_2018) & !is.na(year_2022) & year_2018 != 0) %>%
mutate(increase = (year_2022 - year_2018) / year_2018)
summary_flat
kk_2019_raw %>%
mutate(is_stem = ifelse(subject %in% c("biology", "chemistry", "computer_studies",
"general_science", "maths", "physics"),
"STEM", "non-STEM"),
area = ifelse(area == "kk", "Kakuma_Kalobeyei", area)) %>%
mutate(subtotal = number_candidates * score) %>%
group_by(year, subject, area, is_stem) %>%
summarise(subtotal = sum(subtotal),
count = sum(number_candidates)) %>%
mutate(mean_score = subtotal / count)
summary_flat <- kcse %>%
mutate(area = ifelse(area != "dadaab", "Kakuma_Kalobeyei", "Dadaab")) %>%
filter(subject %out% c("maths_b",
"general_science",
"kenyan_sign_language")) %>%
group_by(year, area, subject, is_stem) %>%
summarise(score = mean(score, na.rm = TRUE)) %>%
rbind(
kk_2019_raw %>%
mutate(is_stem = ifelse(subject %in% c("biology", "chemistry", "computer_studies",
"general_science", "maths", "physics"),
"STEM", "non-STEM"),
area = ifelse(area == "kk", "Kakuma_Kalobeyei", area)) %>%
mutate(subtotal = number_candidates * score) %>%
group_by(year, subject, area, is_stem) %>%
summarise(subtotal = sum(subtotal),
count = sum(number_candidates)) %>%
mutate(score = subtotal / count) %>%
select(-subtotal, -count)
) %>%
pivot_wider(names_from = year, values_from = score, names_prefix = "year_") %>%
filter(!is.na(year_2018) & !is.na(year_2022) & year_2018 != 0) %>%
mutate(increase = (year_2022 - year_2018) / year_2018)
summary_flat
summary_flat %>%
ggplot(aes(x =  area, y = increase, colour = area)) +
geom_boxplot(size = 1) +
geom_point(size = 2, alpha = .5) +
scale_colour_manual(values = c("salmon", "blue2")) +
scale_y_continuous(labels = percent) +
facet_wrap(~ is_stem) +
labs(x = "",
y = "Increase in scores between 2018 and 2020") +
theme(legend.position = "none",
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", face = "bold"),
axis.text.x = element_text(size = 10))
summary_flat %>%
ggplot(aes(x =  area, y = increase, colour = area)) +
geom_boxplot(size = 1) +
geom_point(size = 2, alpha = .5) +
scale_colour_manual(values = c("salmon", "blue2")) +
scale_y_continuous(labels = percent) +
facet_wrap(~ is_stem) +
labs(x = "",
y = "% increase in scores",
title = "Increase in scores in Dadaab, Kakuma and Kalobeyei, 2018-2022") +
theme(legend.position = "none",
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", face = "bold"),
axis.text.x = element_text(size = 10))
summary_flat %>%
ggplot(aes(x =  area, y = increase, colour = area)) +
geom_boxplot(size = 1) +
geom_point(size = 2, alpha = .5) +
scale_colour_manual(values = c("salmon", "blue2")) +
scale_y_continuous(labels = percent) +
facet_wrap(~ is_stem) +
labs(x = "",
y = "% increase in scores",
title = "Changes in scores in Dadaab, Kakuma and Kalobeyei, 2018-2022") +
theme(legend.position = "none",
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", face = "bold"),
axis.text.x = element_text(size = 10))
summary_flat %>%
ggplot(aes(x =  area, y = increase, colour = area)) +
geom_boxplot(size = .7) +
geom_point(size = 2, alpha = .5) +
scale_colour_manual(values = c("salmon", "blue2")) +
scale_y_continuous(labels = percent) +
facet_wrap(~ is_stem) +
labs(x = "",
y = "% increase in scores",
title = "Changes in scores in Dadaab, Kakuma and Kalobeyei, 2018-2022") +
theme(legend.position = "none",
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", face = "bold"),
axis.text.x = element_text(size = 10))
summary_flat %>%
ggplot(aes(x =  is_stem, y = increase, colour = is_stem)) +
geom_boxplot(size = 1) +
geom_point(size = 2, alpha = .5) +
scale_colour_manual(values = c("darkgoldenrod3", "darkslategray4"),
breaks = c("STEM", "non-STEM")) +
theme(legend.position = "none") +
scale_y_continuous(labels = percent) +
labs(x = "",
y = "Increase in scores between 2018 and 2020")
summary_flat %>%
ggplot(aes(x =  area, y = increase, colour = area)) +
geom_boxplot(size = .7) +
geom_point(size = 2, alpha = .5) +
scale_colour_manual(values = c("salmon", "blue2")) +
scale_y_continuous(labels = percent) +
facet_wrap(~ is_stem) +
labs(x = "",
y = "% increase in scores",
title = "Changes in scores in Dadaab, Kakuma and Kalobeyei, 2018-2022") +
theme(legend.position = "none",
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", face = "bold"),
axis.text.x = element_text(size = 10))
summary_flat %>%
ggplot(aes(x =  area, y = increase, colour = area)) +
geom_boxplot(size = .7) +
geom_point(size = 2, alpha = .5) +
scale_colour_manual(values = c("salmon", "blue2")) +
scale_y_continuous(labels = percent) +
geom_hline(yintercept = 0, lty = 2, size = 1, alpha = .3) +
facet_wrap(~ is_stem) +
labs(x = "",
y = "% increase in scores",
title = "Changes in scores in Dadaab, Kakuma and Kalobeyei, 2018-2022") +
theme(legend.position = "none",
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", face = "bold"),
axis.text.x = element_text(size = 10))
summary_flat %>%
ggplot(aes(x =  area, y = increase, colour = area)) +
geom_boxplot(size = .7) +
geom_point(size = 2, alpha = .5) +
scale_colour_manual(values = c("salmon", "blue2")) +
scale_y_continuous(labels = percent) +
geom_hline(yintercept = 0, lty = 2, size = 1, alpha = .3, colour = "grey") +
facet_wrap(~ is_stem) +
labs(x = "",
y = "% increase in scores",
title = "Changes in scores in Dadaab, Kakuma and Kalobeyei, 2018-2022") +
theme(legend.position = "none",
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", face = "bold"),
axis.text.x = element_text(size = 10))
summary_flat %>%
ggplot(aes(x =  area, y = increase, colour = area)) +
geom_boxplot(size = .7) +
geom_point(size = 2, alpha = .5) +
scale_colour_manual(values = c("salmon", "blue2")) +
scale_y_continuous(labels = percent) +
geom_hline(yintercept = 0, lty = 2, size = 1, alpha = .4, colour = "grey") +
facet_wrap(~ is_stem) +
labs(x = "",
y = "% increase in scores",
title = "Changes in scores in Dadaab, Kakuma and Kalobeyei, 2018-2022") +
theme(legend.position = "none",
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", face = "bold"),
axis.text.x = element_text(size = 10))
summary_flat %>%
ggplot(aes(x =  area, y = increase, colour = area)) +
geom_boxplot(size = .7) +
geom_point(size = 2, alpha = .5) +
scale_colour_manual(values = c("salmon", "blue2")) +
scale_y_continuous(labels = percent) +
geom_hline(yintercept = 0, lty = 2, size = 1, alpha = .5, colour = "grey") +
facet_wrap(~ is_stem) +
labs(x = "",
y = "% increase in scores",
title = "Changes in scores in Dadaab, Kakuma and Kalobeyei, 2018-2022") +
theme(legend.position = "none",
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", face = "bold"),
axis.text.x = element_text(size = 10))
summary_flat %>%
ggplot(aes(x =  area, y = increase, colour = area)) +
geom_hline(yintercept = 0, lty = 2, size = 1, alpha = .8, colour = "grey") +
geom_boxplot(size = .7) +
geom_point(size = 2, alpha = .5) +
scale_colour_manual(values = c("salmon", "blue2")) +
scale_y_continuous(labels = percent) +
facet_wrap(~ is_stem) +
labs(x = "",
y = "% increase in scores",
title = "Changes in scores in Dadaab, Kakuma and Kalobeyei, 2018-2022") +
theme(legend.position = "none",
strip.background = element_rect(fill = "black"),
strip.text = element_text(colour = "white", face = "bold"),
axis.text.x = element_text(size = 10))
summary_flat <- kcse %>%
mutate(area = ifelse(area != "dadaab", "Kakuma_Kalobeyei", "Dadaab")) %>%
filter(subject %out% c("maths_b",
"general_science",
"kenyan_sign_language")) %>%
group_by(year, area, subject, is_stem) %>%
summarise(score = mean(score, na.rm = TRUE)) %>%
rbind(
kk_2019_raw %>%
mutate(is_stem = ifelse(subject %in% c("biology", "chemistry", "computer_studies",
"general_science", "maths", "physics"),
"STEM", "non-STEM"),
area = ifelse(area == "kk", "Kakuma_Kalobeyei", area)) %>%
mutate(subtotal = number_candidates * score) %>%
group_by(year, subject, area, is_stem) %>%
summarise(subtotal = sum(subtotal),
count = sum(number_candidates)) %>%
mutate(score = subtotal / count) %>%
select(-subtotal, -count)
) %>%
pivot_wider(names_from = year, values_from = score, names_prefix = "year_") %>%
filter(!is.na(year_2018) & !is.na(year_2022) & year_2018 != 0) %>%
mutate(increase = (year_2022 - year_2018) / year_2018)
summary_flat
summary_flat %>% group_by(is_stem) %>%
summarise(increase = mean(increase, na.rm = TRUE))
summary_flat %>% group_by(is_stem) %>%
summarise(increase = round(mean(increase * 100, na.rm = TRUE), digits = 2))
summary_pc <- summary_flat %>% group_by(is_stem) %>%
summarise(increase = round(mean(increase * 100, na.rm = TRUE), digits = 2))
summary_pc <- summary_flat %>% group_by(is_stem) %>%
summarise(increase = round(mean(increase * 100, na.rm = TRUE), digits = 2))
summary_pc
r summary_pc %>% filter(is_stem == "non-STEM") %>% pull(increase)
summary_pc %>% filter(is_stem == "non-STEM") %>% pull(increase)
summary_pc %>% filter(is_stem == "STEM") %>% pull(increase)
kcse %>%
group_by(subject, year, is_stem) %>%
summarise(score = mean(score, na.rm = TRUE)) %>%
filter(subject %out% c("biology_for_the_blind",
"maths_b",
"general_science",
"kenyan_sign_language")) %>%
group_by(subject, is_stem) %>%
mutate(yoy_change = score - lag(score),
pc_change = yoy_change / score,
overall_change = score[year == 2022] - score[year == 2018],
pc_overall_change = overall_change / score[year == 2018]) %>%
filter(!is.na(yoy_change)) %>%
summarise(yoy_change = mean(yoy_change),
pc_change = mean(pc_change),
overall_change = mean(overall_change),
pc_overall_change = mean(pc_overall_change)) %>%
mutate(subject = str_replace_all(subject, "_", " ")) %>%
ggplot(aes(x = pc_overall_change,
y = fct_reorder(str_to_title(subject), pc_overall_change),
fill = is_stem)) +
geom_col() +
geom_text(aes(label = percent(pc_overall_change, accuracy = 1)),
hjust = "inward") +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("darkgoldenrod3", "darkslategray4"),
breaks = c("STEM", "non-STEM")) +
labs(x = "% change between 2018 and 2022",
y = "",
title = "% change in mean subject scores between 2018 and 2022",)
kcse %>%
group_by(subject, year, is_stem) %>%
summarise(score = mean(score, na.rm = TRUE)) %>%
filter(subject %out% c("biology_for_the_blind",
"maths_b",
"general_science",
"kenyan_sign_language")) %>%
group_by(subject, is_stem) %>%
mutate(yoy_change = score - lag(score),
pc_change = yoy_change / score,
overall_change = score[year == 2022] - score[year == 2018],
pc_overall_change = overall_change / score[year == 2018]) %>%
filter(!is.na(yoy_change)) %>%
summarise(yoy_change = mean(yoy_change),
pc_change = mean(pc_change),
overall_change = mean(overall_change),
pc_overall_change = mean(pc_overall_change)) %>%
mutate(subject = str_replace_all(subject, "_", " ")) %>%
ggplot(aes(x = pc_overall_change,
y = fct_reorder(str_to_title(subject), pc_overall_change),
fill = is_stem)) +
geom_col() +
geom_text(aes(label = percent(pc_overall_change, accuracy = 1)),
hjust = "inward") +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("darkgoldenrod3", "darkslategray4"),
breaks = c("STEM", "non-STEM")) +
labs(x = "% change between 2018 and 2022",
y = "",
title = "% change in mean subject scores between 2018 and 2022",
fill = "")
kcse %>%
group_by(subject, year, is_stem) %>%
summarise(score = mean(score, na.rm = TRUE)) %>%
filter(subject %out% c("maths_b",
"general_science",
"kenyan_sign_language")) %>%
group_by(subject, is_stem) %>%
mutate(yoy_change = score - lag(score),
pc_change = yoy_change / score,
overall_change = score[year == 2022] - score[year == 2018],
pc_overall_change = overall_change / score[year == 2018]) %>%
filter(!is.na(yoy_change)) %>%
summarise(yoy_change = mean(yoy_change),
pc_change = mean(pc_change),
overall_change = mean(overall_change),
pc_overall_change = mean(pc_overall_change)) %>%
mutate(subject = str_replace_all(subject, "_", " ")) %>%
ggplot(aes(x = pc_overall_change,
y = fct_reorder(str_to_title(subject), pc_overall_change),
fill = is_stem)) +
geom_col() +
geom_text(aes(label = percent(pc_overall_change, accuracy = 1)),
hjust = "inward") +
scale_x_continuous(labels = percent) +
scale_fill_manual(values = c("darkgoldenrod3", "darkslategray4"),
breaks = c("STEM", "non-STEM")) +
labs(x = "% change between 2018 and 2022",
y = "",
title = "% change in mean subject scores between 2018 and 2022",
fill = "")
